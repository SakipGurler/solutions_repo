<!DOCTYPE html>

<html class="writer-html5" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<link href="../../../img/favicon.ico" rel="shortcut icon"/>
<title>Lorentz Force Simulation: Charged Particle Motion in Electric and Magnetic Fields - Physics and Mathematics</title>
<link href="../../../css/theme.css" rel="stylesheet"/>
<link href="../../../css/theme_extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" rel="stylesheet"/>
<script>
        // Current page data
        var mkdocs_page_name = "Lorentz Force Simulation: Charged Particle Motion in Electric and Magnetic Fields";
        var mkdocs_page_input_path = "1 Physics/4 Electromagnetism/Problem_1.md";
        var mkdocs_page_url = null;
      </script>
<!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/rust.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>
</head>
<body class="wy-body-for-nav" role="document">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side stickynav" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../../.."> Physics and Mathematics
        </a><div role="search">
<form action="../../../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" title="Type search term here" type="text"/>
</form>
</div>
</div>
<div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../..">Introduction</a>
</li>
</ul>
<p class="caption"><span class="caption-text">1 Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal">1 Mechanics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../1%20Mechanics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Gravity</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_2/">Problem 2</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2%20Gravity/Problem_3/">Problem 3</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Waves</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../3%20Waves/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal current">4 Electromagnetism</a>
<ul class="current">
<li class="toctree-l2 current"><a class="reference internal current" href="#">Lorentz Force Simulation: Charged Particle Motion in Electric and Magnetic Fields</a>
<ul class="current">
<li class="toctree-l3"><a class="reference internal" href="#table-of-contents">Table of Contents</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#introduction-and-applications">Introduction and Applications</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#key-applications">Key Applications</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#theoretical-background">Theoretical Background</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#equations-of-motion">Equations of Motion</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#key-parameters">Key Parameters</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#implementation">Implementation</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#scenario-1-uniform-magnetic-field-circular-motion">Scenario 1 : Uniform Magnetic Field (Circular Motion)</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#scenario-2-combined-e-and-b-fields-helical-motion">Scenario 2 : Combined E and B Fields (Helical Motion)</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#scenario-3-crossed-e-and-b-fields-exb-drift">Scenario 3 : Crossed E and B Fields (ExB Drift)</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#scenario-4-effect-of-initial-velocity-on-trajectory">Scenario 4 : Effect of Initial Velocity on Trajectory</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#simulation-results">Simulation Results</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#scenario-1-uniform-magnetic-field">Scenario 1: Uniform Magnetic Field</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#scenario-2-combined-e-and-b-fields">Scenario 2: Combined E and B Fields</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#scenario-3-crossed-e-and-b-fields">Scenario 3: Crossed E and B Fields</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#scenario-4-variable-initial-velocities">Scenario 4: Variable Initial Velocities</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#practical-applications">Practical Applications</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#1-cyclotron">1. Cyclotron</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#2-mass-spectrometer">2. Mass Spectrometer</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#3-magnetic-plasma-confinement">3. Magnetic Plasma Confinement</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#4-electron-beam-devices">4. Electron Beam Devices</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#extensions-and-future-work">Extensions and Future Work</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#1-non-uniform-fields">1. Non-uniform Fields</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#2-relativistic-effects">2. Relativistic Effects</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#3-multiple-particle-systems">3. Multiple Particle Systems</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#4-time-varying-fields">4. Time-varying Fields</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#5-radiation-effects">5. Radiation Effects</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#6-advanced-numerical-methods">6. Advanced Numerical Methods</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#performance-optimization">Performance Optimization</a>
<ul>
<li class="toctree-l4"><a class="reference internal" href="#computational-considerations">Computational Considerations</a>
</li>
<li class="toctree-l4"><a class="reference internal" href="#accuracy-validation">Accuracy Validation</a>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#conclusion">Conclusion</a>
</li>
<li class="toctree-l3"><a class="reference internal" href="#references-and-further-reading">References and Further Reading</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Circuits</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../5%20Circuits/Problem_1/">Equivalent Resistance Using Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">6 Statistics</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_1/">Problem 1</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../6%20Statistics/Problem_2/">Problem 2</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">7 Measurements</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../7%20Measurements/Problem_1/">Problem 1</a>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">2 Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/1%20Linear_algebra/">Linear Algebra</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/2%20Analytic_geometry/">Analytic geometry</a>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../2%20Mathematics/3%20Calculus/">Calculus</a>
</li>
</ul>
<p class="caption"><span class="caption-text">3 Discret Mathematics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal">1 Set Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_02%20Set_Theory/">Set Theory</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_03%20Relations/">Relations</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/1%20Set%20Theory%20and%20.../_04%20Functions/">Functions</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">2 Number Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_05%20Combinatorics/">Combinatorics</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/2%20Number%20Theory%20and%20.../_08%20Number_Theory/">Number Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">3 Recurrence and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_06%20Sequences_and_Series/">Sequences and Series</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_07%20Induction/">Induction</a>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/3%20Recurrence%20and%20.../_09%20Recurrence/">Recurrence</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">4 Graph Theory and ...</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/4%20Graph%20Theory%20and%20.../_10%20Graph_Theory/">Graph Theory</a>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal">5 Logic</a>
<ul>
<li class="toctree-l2"><a class="reference internal" href="../../../3%20Discret_Mathematics/5%20Logic/_01%20Logic/">Logic</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift">
<nav aria-label="Mobile navigation menu" class="wy-nav-top" role="navigation">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../../..">Physics and Mathematics</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content"><div aria-label="breadcrumbs navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Docs" class="icon icon-home" href="../../.."></a></li>
<li class="breadcrumb-item">1 Physics</li>
<li class="breadcrumb-item">4 Electromagnetism</li>
<li class="breadcrumb-item active">Lorentz Force Simulation: Charged Particle Motion in Electric and Magnetic Fields</li>
<li class="wy-breadcrumbs-aside">
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div class="section" itemprop="articleBody">
<h1 id="lorentz-force-simulation-charged-particle-motion-in-electric-and-magnetic-fields">Lorentz Force Simulation: Charged Particle Motion in Electric and Magnetic Fields</h1>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#introduction-and-applications">Introduction and Applications</a></li>
<li><a href="#theoretical-background">Theoretical Background</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#simulation-results">Simulation Results</a></li>
<li><a href="#practical-applications">Practical Applications</a></li>
<li><a href="#extensions-and-future-work">Extensions and Future Work</a></li>
</ol>
<h2 id="introduction-and-applications">Introduction and Applications</h2>
<p>The Lorentz force is fundamental to understanding charged particle motion in electromagnetic fields. The force equation is:</p>
<p><strong>F = q(E + v × B)</strong></p>
<p>Where:
- <strong>F</strong> = Force vector (N)
- <strong>q</strong> = Particle charge (C)
- <strong>E</strong> = Electric field vector (V/m)
- <strong>v</strong> = Particle velocity vector (m/s)
- <strong>B</strong> = Magnetic field vector (T)</p>
<h3 id="key-applications">Key Applications</h3>
<ol>
<li><strong>Particle Accelerators</strong></li>
<li>Cyclotrons use magnetic fields to accelerate particles in spiral paths</li>
<li>Linear accelerators use electric fields for acceleration</li>
<li>
<p>Synchrotrons combine both fields for high-energy particle physics</p>
</li>
<li>
<p><strong>Mass Spectrometers</strong></p>
</li>
<li>Separate ions based on mass-to-charge ratio</li>
<li>
<p>Magnetic field curves particle paths differently based on m/q</p>
</li>
<li>
<p><strong>Plasma Confinement</strong></p>
</li>
<li>Tokamaks and stellarators use magnetic fields to confine plasma</li>
<li>
<p>Magnetic mirror traps use field gradients</p>
</li>
<li>
<p><strong>Electron Guns and CRT Displays</strong></p>
</li>
<li>Electric fields accelerate and focus electron beams</li>
<li>Magnetic fields deflect beams for scanning</li>
</ol>
<h2 id="theoretical-background">Theoretical Background</h2>
<h3 id="equations-of-motion">Equations of Motion</h3>
<p>From Newton's second law and the Lorentz force:</p>
<p><strong>m(dv/dt) = q(E + v × B)</strong></p>
<p>In component form:
- <strong>dvx/dt = (q/m)(Ex + vy<em>Bz - vz</em>By)</strong>
- <strong>dvy/dt = (q/m)(Ey + vz<em>Bx - vx</em>Bz)</strong>
- <strong>dvz/dt = (q/m)(Ez + vx<em>By - vy</em>Bx)</strong></p>
<h3 id="key-parameters">Key Parameters</h3>
<ol>
<li><strong>Cyclotron Frequency</strong>: ωc = qB/m</li>
<li><strong>Larmor Radius</strong>: rL = mv⊥/(qB)</li>
<li><strong>Drift Velocity</strong>: vD = (E × B)/B²</li>
</ol>
<h2 id="implementation">Implementation</h2>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from matplotlib.animation import FuncAnimation
import warnings
warnings.filterwarnings('ignore')

class LorentzForceSimulator:
    """
    Simulator for charged particle motion under Lorentz force
    """

    def __init__(self, charge=1.602e-19, mass=9.109e-31):
        """
        Initialize simulator with particle properties

        Parameters:
        charge (float): Particle charge in Coulombs (default: electron charge)
        mass (float): Particle mass in kg (default: electron mass)
        """
        self.q = charge  # Coulombs
        self.m = mass    # kg
        self.c = 2.998e8 # Speed of light (m/s)

    def lorentz_force(self, t, state, E_field, B_field):
        """
        Calculate Lorentz force and derivatives

        Parameters:
        t (float): Time
        state (array): [x, y, z, vx, vy, vz]
        E_field (function or array): Electric field E(x,y,z,t) or constant
        B_field (function or array): Magnetic field B(x,y,z,t) or constant

        Returns:
        array: Derivatives [dx/dt, dy/dt, dz/dt, dvx/dt, dvy/dt, dvz/dt]
        """
        x, y, z, vx, vy, vz = state

        # Get field values
        if callable(E_field):
            Ex, Ey, Ez = E_field(x, y, z, t)
        else:
            Ex, Ey, Ez = E_field

        if callable(B_field):
            Bx, By, Bz = B_field(x, y, z, t)
        else:
            Bx, By, Bz = B_field

        # Calculate acceleration from Lorentz force
        # F = q(E + v × B)
        # v × B = [vy*Bz - vz*By, vz*Bx - vx*Bz, vx*By - vy*Bx]

        ax = (self.q/self.m) * (Ex + vy*Bz - vz*By)
        ay = (self.q/self.m) * (Ey + vz*Bx - vx*Bz)
        az = (self.q/self.m) * (Ez + vx*By - vy*Bx)

        return np.array([vx, vy, vz, ax, ay, az])

    def runge_kutta_4(self, f, t0, state0, dt, n_steps, *args):
        """
        4th order Runge-Kutta integration

        Parameters:
        f (function): Derivative function
        t0 (float): Initial time
        state0 (array): Initial state
        dt (float): Time step
        n_steps (int): Number of steps
        *args: Additional arguments for f

        Returns:
        tuple: (time_array, state_array)
        """
        t = np.zeros(n_steps + 1)
        state = np.zeros((n_steps + 1, len(state0)))

        t[0] = t0
        state[0] = state0

        for i in range(n_steps):
            k1 = f(t[i], state[i], *args)
            k2 = f(t[i] + dt/2, state[i] + dt*k1/2, *args)
            k3 = f(t[i] + dt/2, state[i] + dt*k2/2, *args)
            k4 = f(t[i] + dt, state[i] + dt*k3, *args)

            state[i+1] = state[i] + dt/6 * (k1 + 2*k2 + 2*k3 + k4)
            t[i+1] = t[i] + dt

        return t, state

    def simulate_motion(self, initial_pos, initial_vel, E_field, B_field, 
                       t_max=1e-6, dt=1e-9):
        """
        Simulate particle motion

        Parameters:
        initial_pos (array): Initial position [x, y, z] in meters
        initial_vel (array): Initial velocity [vx, vy, vz] in m/s
        E_field (array or function): Electric field
        B_field (array or function): Magnetic field
        t_max (float): Maximum simulation time
        dt (float): Time step

        Returns:
        dict: Simulation results
        """
        initial_state = np.concatenate([initial_pos, initial_vel])
        n_steps = int(t_max / dt)

        t, states = self.runge_kutta_4(
            self.lorentz_force, 0, initial_state, dt, n_steps, E_field, B_field
        )

        # Extract position and velocity
        positions = states[:, :3]
        velocities = states[:, 3:]

        # Calculate kinetic energy
        ke = 0.5 * self.m * np.sum(velocities**2, axis=1)

        return {
            'time': t,
            'position': positions,
            'velocity': velocities,
            'kinetic_energy': ke,
            'speed': np.linalg.norm(velocities, axis=1)
        }

    def calculate_cyclotron_frequency(self, B_magnitude):
        """Calculate cyclotron frequency"""
        return abs(self.q) * B_magnitude / self.m

    def calculate_larmor_radius(self, v_perp, B_magnitude):
        """Calculate Larmor radius"""
        return self.m * v_perp / (abs(self.q) * B_magnitude)

# Simulation scenarios
def run_simulations():
    """Run various simulation scenarios"""

    # Initialize simulator with electron properties
    sim = LorentzForceSimulator()

    # Common parameters
    dt = 1e-10  # 0.1 ns time step
    t_max = 5e-8  # 50 ns simulation time

    results = {}

    # Scenario 1: Uniform magnetic field (circular motion)
    print("Running Scenario 1: Uniform Magnetic Field")
    B_uniform = np.array([0, 0, 1.0])  # 1 Tesla in z-direction
    E_zero = np.array([0, 0, 0])

    initial_pos = np.array([0, 0, 0])
    initial_vel = np.array([1e6, 0, 0])  # 1 million m/s in x-direction

    results['uniform_B'] = sim.simulate_motion(
        initial_pos, initial_vel, E_zero, B_uniform, t_max, dt
    )

    # Calculate theoretical values
    v_perp = np.linalg.norm(initial_vel[:2])
    B_mag = np.linalg.norm(B_uniform)
    omega_c = sim.calculate_cyclotron_frequency(B_mag)
    r_L = sim.calculate_larmor_radius(v_perp, B_mag)

    print(f"Cyclotron frequency: {omega_c:.2e} rad/s")
    print(f"Larmor radius: {r_L:.6f} m")

    # Scenario 2: Combined E and B fields (helical motion)
    print("\\nRunning Scenario 2: Combined E and B Fields")
    E_combined = np.array([0, 0, 1e5])  # 100 kV/m in z-direction
    B_combined = np.array([0, 0, 0.5])  # 0.5 Tesla in z-direction

    results['combined_EB'] = sim.simulate_motion(
        initial_pos, initial_vel, E_combined, B_combined, t_max, dt
    )

    # Scenario 3: Crossed E and B fields (ExB drift)
    print("Running Scenario 3: Crossed E and B Fields")
    E_crossed = np.array([1e4, 0, 0])   # 10 kV/m in x-direction
    B_crossed = np.array([0, 0, 0.1])   # 0.1 Tesla in z-direction

    # Calculate theoretical drift velocity
    E_cross_B = np.cross(E_crossed, B_crossed)
    B_squared = np.dot(B_crossed, B_crossed)
    v_drift_theory = E_cross_B / B_squared

    print(f"Theoretical drift velocity: {v_drift_theory}")

    initial_vel_drift = np.array([0, 1e5, 0])  # Initial velocity in y-direction

    results['crossed_EB'] = sim.simulate_motion(
        initial_pos, initial_vel_drift, E_crossed, B_crossed, t_max*2, dt
    )

    # Scenario 4: Variable initial velocities
    print("\\nRunning Scenario 4: Variable Initial Velocities")
    velocities = [
        np.array([5e5, 0, 0]),
        np.array([1e6, 0, 0]),
        np.array([2e6, 0, 0])
    ]

    results['variable_v'] = []
    for i, vel in enumerate(velocities):
        result = sim.simulate_motion(
            initial_pos, vel, E_zero, B_uniform, t_max, dt
        )
        results['variable_v'].append(result)

    return results, sim

def create_visualizations(results, sim):
    """Create comprehensive visualizations"""

    plt.rcParams.update({'font.size': 10})

    # Figure 1: Uniform magnetic field (circular motion)
    fig1, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(12, 10))
    fig1.suptitle('Scenario 1: Uniform Magnetic Field (Circular Motion)', fontsize=14)

    pos = results['uniform_B']['position']
    vel = results['uniform_B']['velocity']
    t = results['uniform_B']['time']

    # 2D trajectory
    ax1.plot(pos[:, 0]*1e6, pos[:, 1]*1e6, 'b-', linewidth=2)
    ax1.set_xlabel('X Position (μm)')
    ax1.set_ylabel('Y Position (μm)')
    ax1.set_title('Circular Trajectory')
    ax1.grid(True, alpha=0.3)
    ax1.axis('equal')

    # Velocity components
    ax2.plot(t*1e9, vel[:, 0]*1e-6, 'r-', label='vx', linewidth=2)
    ax2.plot(t*1e9, vel[:, 1]*1e-6, 'g-', label='vy', linewidth=2)
    ax2.set_xlabel('Time (ns)')
    ax2.set_ylabel('Velocity (Mm/s)')
    ax2.set_title('Velocity Components')
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    # Kinetic energy
    ax3.plot(t*1e9, results['uniform_B']['kinetic_energy']*1e18, 'purple', linewidth=2)
    ax3.set_xlabel('Time (ns)')
    ax3.set_ylabel('Kinetic Energy (10⁻¹⁸ J)')
    ax3.set_title('Kinetic Energy Conservation')
    ax3.grid(True, alpha=0.3)

    # Speed
    ax4.plot(t*1e9, results['uniform_B']['speed']*1e-6, 'orange', linewidth=2)
    ax4.set_xlabel('Time (ns)')
    ax4.set_ylabel('Speed (Mm/s)')
    ax4.set_title('Speed Magnitude')
    ax4.grid(True, alpha=0.3)

    plt.tight_layout()

    # Figure 2: Combined E and B fields (helical motion)
    fig2 = plt.figure(figsize=(14, 10))
    fig2.suptitle('Scenario 2: Combined E and B Fields (Helical Motion)', fontsize=14)

    # 3D trajectory
    ax_3d = fig2.add_subplot(221, projection='3d')
    pos_comb = results['combined_EB']['position']
    ax_3d.plot(pos_comb[:, 0]*1e6, pos_comb[:, 1]*1e6, pos_comb[:, 2]*1e6, 
               'b-', linewidth=2)
    ax_3d.set_xlabel('X (μm)')
    ax_3d.set_ylabel('Y (μm)')
    ax_3d.set_zlabel('Z (μm)')
    ax_3d.set_title('3D Helical Trajectory')

    # XY projection
    ax_xy = fig2.add_subplot(222)
    ax_xy.plot(pos_comb[:, 0]*1e6, pos_comb[:, 1]*1e6, 'r-', linewidth=2)
    ax_xy.set_xlabel('X Position (μm)')
    ax_xy.set_ylabel('Y Position (μm)')
    ax_xy.set_title('XY Projection')
    ax_xy.grid(True, alpha=0.3)
    ax_xy.axis('equal')

    # Z motion
    ax_z = fig2.add_subplot(223)
    t_comb = results['combined_EB']['time']
    ax_z.plot(t_comb*1e9, pos_comb[:, 2]*1e6, 'g-', linewidth=2)
    ax_z.set_xlabel('Time (ns)')
    ax_z.set_ylabel('Z Position (μm)')
    ax_z.set_title('Acceleration in Z Direction')
    ax_z.grid(True, alpha=0.3)

    # Energy
    ax_energy = fig2.add_subplot(224)
    ke_comb = results['combined_EB']['kinetic_energy']
    ax_energy.plot(t_comb*1e9, ke_comb*1e18, 'purple', linewidth=2)
    ax_energy.set_xlabel('Time (ns)')
    ax_energy.set_ylabel('Kinetic Energy (10⁻¹⁸ J)')
    ax_energy.set_title('Energy Increase Due to E Field')
    ax_energy.grid(True, alpha=0.3)

    plt.tight_layout()

    # Figure 3: Crossed E and B fields (ExB drift)
    fig3, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(12, 10))
    fig3.suptitle('Scenario 3: Crossed E and B Fields (ExB Drift)', fontsize=14)

    pos_cross = results['crossed_EB']['position']
    t_cross = results['crossed_EB']['time']
    vel_cross = results['crossed_EB']['velocity']

    # Trajectory showing drift
    ax1.plot(pos_cross[:, 0]*1e6, pos_cross[:, 1]*1e6, 'b-', linewidth=1)
    ax1.set_xlabel('X Position (μm)')
    ax1.set_ylabel('Y Position (μm)')
    ax1.set_title('Cycloid Motion with Drift')
    ax1.grid(True, alpha=0.3)

    # Drift velocity analysis
    # Calculate average drift by fitting linear trend to position
    mid_idx = len(pos_cross) // 2
    y_drift = pos_cross[mid_idx:, 1]
    t_drift = t_cross[mid_idx:]

    if len(t_drift) &gt; 1:
        drift_coeff = np.polyfit(t_drift, y_drift, 1)
        v_drift_measured = drift_coeff[0]

        ax2.plot(t_cross*1e9, pos_cross[:, 1]*1e6, 'g-', linewidth=2, label='Actual')
        ax2.plot(t_drift*1e9, np.polyval(drift_coeff, t_drift)*1e6, 'r--', 
                linewidth=2, label=f'Linear fit (drift = {v_drift_measured:.0f} m/s)')
        ax2.set_xlabel('Time (ns)')
        ax2.set_ylabel('Y Position (μm)')
        ax2.set_title('Drift Motion Analysis')
        ax2.legend()
        ax2.grid(True, alpha=0.3)

    # Velocity components
    ax3.plot(t_cross*1e9, vel_cross[:, 0]*1e-3, 'r-', label='vx', linewidth=1)
    ax3.plot(t_cross*1e9, vel_cross[:, 1]*1e-3, 'g-', label='vy', linewidth=1)
    ax3.set_xlabel('Time (ns)')
    ax3.set_ylabel('Velocity (km/s)')
    ax3.set_title('Velocity Oscillations')
    ax3.legend()
    ax3.grid(True, alpha=0.3)

    # Phase space plot
    ax4.plot(pos_cross[:, 0]*1e6, vel_cross[:, 0]*1e-3, 'b-', linewidth=1)
    ax4.set_xlabel('X Position (μm)')
    ax4.set_ylabel('X Velocity (km/s)')
    ax4.set_title('Phase Space (X)')
    ax4.grid(True, alpha=0.3)

    plt.tight_layout()

    # Figure 4: Variable initial velocities
    fig4, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(12, 10))
    fig4.suptitle('Scenario 4: Effect of Initial Velocity on Trajectory', fontsize=14)

    colors = ['red', 'blue', 'green']
    velocities = [5e5, 1e6, 2e6]

    for i, (result, color, v0) in enumerate(zip(results['variable_v'], colors, velocities)):
        pos = result['position']

        # Trajectories
        ax1.plot(pos[:, 0]*1e6, pos[:, 1]*1e6, color=color, linewidth=2,
                label=f'v₀ = {v0*1e-6:.1f} Mm/s')

        # Larmor radii
        B_mag = 1.0  # Tesla
        r_L = sim.calculate_larmor_radius(v0, B_mag)
        ax2.scatter(v0*1e-6, r_L*1e6, color=color, s=100, 
                   label=f'v₀ = {v0*1e-6:.1f} Mm/s')

    ax1.set_xlabel('X Position (μm)')
    ax1.set_ylabel('Y Position (μm)')
    ax1.set_title('Circular Trajectories')
    ax1.legend()
    ax1.grid(True, alpha=0.3)
    ax1.axis('equal')

    ax2.set_xlabel('Initial Velocity (Mm/s)')
    ax2.set_ylabel('Larmor Radius (μm)')
    ax2.set_title('Larmor Radius vs Initial Velocity')
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    # Cyclotron frequencies
    B_mag = 1.0
    omega_c = sim.calculate_cyclotron_frequency(B_mag)
    periods = 2 * np.pi / omega_c

    ax3.axhline(y=omega_c*1e-9, color='black', linestyle='--', linewidth=2,
               label=f'ωc = {omega_c:.2e} rad/s')
    ax3.set_xlabel('Initial Velocity (Mm/s)')
    ax3.set_ylabel('Cyclotron Frequency (GHz)')
    ax3.set_title('Cyclotron Frequency (Independent of Velocity)')
    ax3.legend()
    ax3.grid(True, alpha=0.3)
    ax3.set_ylim([omega_c*1e-9*0.9, omega_c*1e-9*1.1])

    ax4.axhline(y=periods*1e9, color='black', linestyle='--', linewidth=2,
               label=f'T = {periods*1e9:.2f} ns')
    ax4.set_xlabel('Initial Velocity (Mm/s)')
    ax4.set_ylabel('Period (ns)')
    ax4.set_title('Cyclotron Period (Independent of Velocity)')
    ax4.legend()
    ax4.grid(True, alpha=0.3)
    ax4.set_ylim([periods*1e9*0.9, periods*1e9*1.1])

    plt.tight_layout()

    plt.show()

# Main execution
if __name__ == "__main__":
    print("Starting Lorentz Force Simulations...")
    print("=" * 50)

    # Run simulations
    results, simulator = run_simulations()

    print("\\nCreating visualizations...")
    create_visualizations(results, simulator)

    print("\\nSimulation completed successfully!")
</code></pre>
<h3 id="scenario-1-uniform-magnetic-field-circular-motion">Scenario 1 : Uniform Magnetic Field (Circular Motion)</h3>
<p><img alt="alt text" src="../image.png"/></p>
<h3 id="scenario-2-combined-e-and-b-fields-helical-motion">Scenario 2 : Combined E and B Fields (Helical Motion)</h3>
<p><img alt="alt text" src="../image-4.png"/></p>
<h3 id="scenario-3-crossed-e-and-b-fields-exb-drift">Scenario 3 : Crossed E and B Fields (ExB Drift)</h3>
<p><img alt="alt text" src="../image-8.png"/></p>
<h3 id="scenario-4-effect-of-initial-velocity-on-trajectory">Scenario 4 : Effect of Initial Velocity on Trajectory</h3>
<p><img alt="alt text" src="../image-12.png"/> </p>
<h2 id="simulation-results">Simulation Results</h2>
<h3 id="scenario-1-uniform-magnetic-field">Scenario 1: Uniform Magnetic Field</h3>
<ul>
<li><strong>Observation</strong>: Particles follow perfect circular trajectories</li>
<li><strong>Key Physics</strong>: Magnetic force provides centripetal force</li>
<li><strong>Conservation</strong>: Kinetic energy and speed remain constant</li>
<li><strong>Formula</strong>: Cyclotron frequency ωc = qB/m is independent of velocity</li>
</ul>
<h3 id="scenario-2-combined-e-and-b-fields">Scenario 2: Combined E and B Fields</h3>
<ul>
<li><strong>Observation</strong>: Helical motion with acceleration along E field</li>
<li><strong>Key Physics</strong>: Magnetic field causes circular motion, electric field accelerates</li>
<li><strong>Energy</strong>: Kinetic energy increases due to work done by electric field</li>
<li><strong>Applications</strong>: Particle accelerators, electron guns</li>
</ul>
<h3 id="scenario-3-crossed-e-and-b-fields">Scenario 3: Crossed E and B Fields</h3>
<ul>
<li><strong>Observation</strong>: Cycloid motion with net drift velocity</li>
<li><strong>Key Physics</strong>: ExB drift perpendicular to both fields</li>
<li><strong>Drift Velocity</strong>: vD = (E × B)/B²</li>
<li><strong>Applications</strong>: Mass spectrometers, plasma diagnostics</li>
</ul>
<h3 id="scenario-4-variable-initial-velocities">Scenario 4: Variable Initial Velocities</h3>
<ul>
<li><strong>Observation</strong>: Larger velocities create larger circular orbits</li>
<li><strong>Key Physics</strong>: Larmor radius rL = mv⊥/(qB) scales with velocity</li>
<li><strong>Invariant</strong>: Cyclotron frequency independent of velocity</li>
<li><strong>Applications</strong>: Velocity selection, focusing systems</li>
</ul>
<h2 id="practical-applications">Practical Applications</h2>
<h3 id="1-cyclotron">1. Cyclotron</h3>
<ul>
<li>Uses uniform magnetic field to accelerate particles in spiral path</li>
<li><strong>Key Parameters</strong>:</li>
<li>Cyclotron frequency: ωc = qB/m</li>
<li>Maximum energy limited by relativistic effects</li>
<li>Resonance condition: RF frequency = cyclotron frequency</li>
</ul>
<h3 id="2-mass-spectrometer">2. Mass Spectrometer</h3>
<ul>
<li>Separates ions based on mass-to-charge ratio</li>
<li><strong>Operating Principle</strong>:</li>
<li>Magnetic field curves ion paths</li>
<li>Radius of curvature: r = mv/(qB)</li>
<li>Different m/q ratios follow different paths</li>
</ul>
<h3 id="3-magnetic-plasma-confinement">3. Magnetic Plasma Confinement</h3>
<ul>
<li>Tokamaks and stellarators confine hot plasma</li>
<li><strong>Confinement Mechanism</strong>:</li>
<li>Magnetic field lines guide particle motion</li>
<li>Cross-field transport minimized</li>
<li>ExB drift controlled by field geometry</li>
</ul>
<h3 id="4-electron-beam-devices">4. Electron Beam Devices</h3>
<ul>
<li>CRT displays, electron microscopes, welding equipment</li>
<li><strong>Control Methods</strong>:</li>
<li>Electric fields for acceleration and focusing</li>
<li>Magnetic fields for deflection and scanning</li>
<li>Combined fields for precise beam control</li>
</ul>
<h2 id="extensions-and-future-work">Extensions and Future Work</h2>
<h3 id="1-non-uniform-fields">1. Non-uniform Fields</h3>
<pre><code class="language-python"># Example: Magnetic mirror field
def magnetic_mirror_field(x, y, z, t):
    B0 = 1.0  # Tesla
    gradient = 0.1  # T/m
    Bz = B0 * (1 + gradient * z)
    return np.array([0, 0, Bz])
</code></pre>
<h3 id="2-relativistic-effects">2. Relativistic Effects</h3>
<ul>
<li>Modify equations for high-energy particles</li>
<li>Include relativistic mass increase: γ = 1/√(1 - v²/c²)</li>
<li><strong>Modified Equation</strong>: m₀γ(dv/dt) = q(E + v × B)</li>
</ul>
<h3 id="3-multiple-particle-systems">3. Multiple Particle Systems</h3>
<ul>
<li>Include particle-particle interactions</li>
<li>Coulomb forces between charged particles</li>
<li>Collective plasma effects</li>
</ul>
<h3 id="4-time-varying-fields">4. Time-varying Fields</h3>
<pre><code class="language-python"># Example: Oscillating electric field
def oscillating_E_field(x, y, z, t):
    E0 = 1e5  # V/m
    omega = 1e9  # rad/s
    Ex = E0 * np.cos(omega * t)
    return np.array([Ex, 0, 0])
</code></pre>
<h3 id="5-radiation-effects">5. Radiation Effects</h3>
<ul>
<li>Include synchrotron radiation for accelerating charges</li>
<li>Energy loss affects particle trajectories</li>
<li>Important for high-energy applications</li>
</ul>
<h3 id="6-advanced-numerical-methods">6. Advanced Numerical Methods</h3>
<ul>
<li>Adaptive time stepping</li>
<li>Symplectic integrators for energy conservation</li>
<li>Particle-in-cell (PIC) methods for plasma simulation</li>
</ul>
<h2 id="performance-optimization">Performance Optimization</h2>
<h3 id="computational-considerations">Computational Considerations</h3>
<ol>
<li><strong>Time Step Selection</strong>: Balance accuracy vs. computation time</li>
<li><strong>Vectorization</strong>: Use NumPy operations for speed</li>
<li><strong>Memory Management</strong>: Store only necessary data points</li>
<li><strong>Parallel Processing</strong>: Multiple particle simulations</li>
</ol>
<h3 id="accuracy-validation">Accuracy Validation</h3>
<ol>
<li><strong>Energy Conservation</strong>: Monitor kinetic energy in pure magnetic fields</li>
<li><strong>Analytical Solutions</strong>: Compare with known circular/helical trajectories</li>
<li><strong>Parameter Scaling</strong>: Verify dimensional analysis</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>The Lorentz force simulation demonstrates fundamental electromagnetic phenomena crucial to modern technology. Key insights include:</p>
<ol>
<li><strong>Magnetic fields</strong> alone change particle direction, not speed</li>
<li><strong>Electric fields</strong> change particle energy and speed</li>
<li><strong>Combined fields</strong> create complex but predictable motion patterns</li>
<li><strong>Field geometry</strong> determines confinement and focusing properties</li>
</ol>
<p>These simulations provide intuitive understanding of particle accelerators, plasma physics, and electromagnetic devices, forming the foundation for advanced applications in physics and engineering.</p>
<h2 id="references-and-further-reading">References and Further Reading</h2>
<ol>
<li><strong>Classical Electrodynamics</strong> - J.D. Jackson</li>
<li><strong>Introduction to Plasma Physics</strong> - F.F. Chen</li>
<li><strong>Principles of Charged Particle Acceleration</strong> - S.Y. Lee</li>
<li><strong>Computational Physics</strong> - N. Giordano &amp; H. Nakanishi</li>
</ol>
<hr/>
<p><em>This analysis demonstrates the power of computational physics in understanding fundamental electromagnetic phenomena and their technological applications.</em></p>
</div>
</div><footer>
<div aria-label="Footer Navigation" class="rst-footer-buttons" role="navigation">
<a class="btn btn-neutral float-left" href="../../3%20Waves/Problem_1/" title="Problem 1"><span class="icon icon-circle-arrow-left"></span> Previous</a>
<a class="btn btn-neutral float-right" href="../../5%20Circuits/Problem_1/" title="Equivalent Resistance Using Graph Theory">Next <span class="icon icon-circle-arrow-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<!-- Copyright etc -->
</div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
</div>
</div>
</section>
</div>
<div aria-label="Versions" class="rst-versions" role="note">
<span class="rst-current-version" data-toggle="rst-current-version">
<span><a href="../../3%20Waves/Problem_1/" style="color: #fcfcfc">« Previous</a></span>
<span><a href="../../5%20Circuits/Problem_1/" style="color: #fcfcfc">Next »</a></span>
</span>
</div>
<script src="../../../js/jquery-3.6.0.min.js"></script>
<script>var base_url = "../../..";</script>
<script src="../../../js/theme_extra.js"></script>
<script src="../../../js/theme.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="../../../search/main.js"></script>
<script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>
</body>
</html>
